<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kosta.starware.mapper.ScheduleMapper">

<!--   <select id="getList" resultType="org.zerock.domain.BoardVO">
  	<![CDATA[select * from schedule where bno > 0 order by bno]]>
  </select> -->

  <insert id="insertSch">
  	<selectKey resultType="int" keyProperty="schedule_no" order="BEFORE">
        select MAX(schedule_no)+1 from schedule        
    </selectKey>
  		insert into 
  		schedule(schedule_no, emp_no, category_no, schedule_title, schedule_contents, schedule_regdate, schedule_starttime, schedule_endtime) 
  		values(#{schedule_no}, #{emp_no}, #{category_no}, #{schedule_title}, #{schedule_contents}, sysdate, #{schedule_starttime}, #{schedule_endtime})
  </insert>

  <insert id="addAttendeeSch">
  	insert into 
  	schedule(schedule_no, emp_no, category_no, schedule_title, schedule_contents, schedule_regdate, schedule_starttime, schedule_endtime) 
  		values(#{schedule_no}, #{emp_no}, #{category_no}, #{schedule_title}, #{schedule_contents}, sysdate, #{schedule_starttime}, #{schedule_endtime})
  </insert>
  
  <select id="listSch" resultType="kosta.starware.domain.ScheduleVO">
  	select distinct schedule_no, s.category_no as category_no, s.emp_no as emp_no, schedule_title, schedule_contents, schedule_starttime, schedule_endtime, category_name, category_color, attcount 
  	from schedule s, category c where s.category_no = c.category_no and s.emp_no = #{emp_no} order by schedule_no
  </select>
  
  <select id="getSch" resultType="kosta.starware.domain.ScheduleVO">
  	select distinct schedule_no, s.category_no as category_no, s.emp_no as emp_no, schedule_title, schedule_contents, schedule_starttime, schedule_endtime, category_name, category_color, attcount 
  	from schedule s, category c where s.category_no = c.category_no and s.emp_no = #{emp_no} and schedule_no = #{schedule_no} order by schedule_no
  </select>
  
  <select id="listEmpBySno" resultType="kosta.starware.domain.ScheduleVO">
  	select s.emp_no, emp_name, dept_name from schedule s, emp e, dept d where s.emp_no = e.emp_no and e.dept_no = d.dept_no and schedule_no = #{schedule_no}
  </select>
  
 
  

</mapper>
